# æ•°å­—æƒ å†œAPPåç«¯æœåŠ¡ API æµ‹è¯•ç»“æœæ±‡æ€»

## æµ‹è¯•ç¯å¢ƒ
- **æœåŠ¡åœ°å€**: http://localhost:8080
- **APIç‰ˆæœ¬**: v1
- **æµ‹è¯•æ—¶é—´**: 2024å¹´æµ‹è¯•
- **æœåŠ¡çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ

## æµ‹è¯•ç»“æœæ¦‚è§ˆ

### âœ… å·²é€šè¿‡æµ‹è¯•çš„æ¥å£

#### 1. å¥åº·æ£€æŸ¥æ¥å£
- **æ¥å£**: `GET /health`
- **çŠ¶æ€**: âœ… é€šè¿‡
- **å“åº”**: 
```json
{
  "code": 0,
  "message": "Success",
  "data": {
    "service": "digital-agriculture-backend",
    "status": "ok",
    "version": "1.0.0"
  }
}
```

#### 2. ç”¨æˆ·æœåŠ¡æ¥å£

##### 2.1 å‘é€éªŒè¯ç 
- **æ¥å£**: `POST /api/v1/users/send-verification-code`
- **çŠ¶æ€**: âœ… é€šè¿‡
- **è¯·æ±‚å‚æ•°**: `{"phone": "13800138000"}`
- **å“åº”**: 
```json
{
  "code": 0,
  "message": "éªŒè¯ç å‘é€æˆåŠŸ"
}
```

##### 2.2 ç”¨æˆ·æ³¨å†Œ 
- **æ¥å£**: `POST /api/v1/users/register`
- **çŠ¶æ€**: ğŸŸ¡ å¾…å®Œæ•´æµ‹è¯•
- **è¯´æ˜**: æ¥å£å¯è®¿é—®ï¼Œéœ€è¦å®Œæ•´åŠŸèƒ½æµ‹è¯•

##### 2.3 ç”¨æˆ·ç™»å½•
- **æ¥å£**: `POST /api/v1/users/login`
- **çŠ¶æ€**: ğŸŸ¡ å¾…å®Œæ•´æµ‹è¯•
- **è¯´æ˜**: æ¥å£å¯è®¿é—®ï¼Œéœ€è¦éªŒè¯JWTç”Ÿæˆ

##### 2.4 è·å–ç”¨æˆ·ä¿¡æ¯
- **æ¥å£**: `GET /api/v1/users/me`
- **çŠ¶æ€**: ğŸŸ¡ å¾…è®¤è¯æµ‹è¯•
- **è¯´æ˜**: éœ€è¦æœ‰æ•ˆTokenè¿›è¡Œæµ‹è¯•

##### 2.5 æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- **æ¥å£**: `PUT /api/v1/users/me`
- **çŠ¶æ€**: ğŸŸ¡ å¾…è®¤è¯æµ‹è¯•
- **è¯´æ˜**: éœ€è¦æœ‰æ•ˆTokenè¿›è¡Œæµ‹è¯•

#### 3. è´·æ¬¾æœåŠ¡æ¥å£

##### 3.1 è·å–è´·æ¬¾äº§å“åˆ—è¡¨
- **æ¥å£**: `GET /api/v1/loans/products`
- **çŠ¶æ€**: âœ… é€šè¿‡
- **å“åº”ç¤ºä¾‹**: 
```json
{
  "code": 0,
  "message": "Success",
  "data": [
    {
      "product_id": "lp_b8a451a7-9c9",
      "name": "æ˜¥è€•åŠ©åŠ›è´·",
      "description": "ä¸“ä¸ºæ˜¥è€•ç”Ÿäº§è®¾è®¡ï¼Œåˆ©ç‡ä¼˜æƒ ï¼Œå¿«é€Ÿå®¡æ‰¹",
      "category": "ç§æ¤è´·",
      "min_amount": 5000,
      "max_amount": 50000,
      "min_term_months": 6,
      "max_term_months": 24,
      "interest_rate_yearly": "4.5% - 6.0%",
      "status": 0
    },
    {
      "product_id": "lp_a2f345b8-1d4",
      "name": "å†œæœºè´­ç½®è´·",
      "description": "æ”¯æŒå†œæˆ·è´­ä¹°å†œä¸šæœºæ¢°ï¼ŒåŠ©åŠ›å†œä¸šç°ä»£åŒ–",
      "category": "è®¾å¤‡è´·",
      "min_amount": 10000,
      "max_amount": 200000,
      "min_term_months": 12,
      "max_term_months": 60,
      "interest_rate_yearly": "5.0% - 7.0%",
      "status": 0
    }
  ]
}
```

##### 3.2 æŒ‰åˆ†ç±»æŸ¥è¯¢è´·æ¬¾äº§å“
- **æ¥å£**: `GET /api/v1/loans/products?category=ç§æ¤è´·`
- **çŠ¶æ€**: âœ… é€šè¿‡
- **è¯´æ˜**: æ”¯æŒåˆ†ç±»ç­›é€‰åŠŸèƒ½

##### 3.3 è·å–è´·æ¬¾äº§å“è¯¦æƒ…
- **æ¥å£**: `GET /api/v1/loans/products/{product_id}`
- **çŠ¶æ€**: âœ… é€šè¿‡
- **è¯´æ˜**: å¯ä»¥è·å–å…·ä½“äº§å“è¯¦ç»†ä¿¡æ¯

##### 3.4 æäº¤è´·æ¬¾ç”³è¯·
- **æ¥å£**: `POST /api/v1/loans/applications`
- **çŠ¶æ€**: ğŸŸ¡ å¾…è®¤è¯æµ‹è¯•
- **è¯´æ˜**: éœ€è¦ç”¨æˆ·Tokenè®¤è¯

##### 3.5 è·å–æˆ‘çš„è´·æ¬¾ç”³è¯·åˆ—è¡¨
- **æ¥å£**: `GET /api/v1/loans/applications/my`
- **çŠ¶æ€**: ğŸŸ¡ å¾…è®¤è¯æµ‹è¯•
- **è¯´æ˜**: éœ€è¦ç”¨æˆ·Tokenè®¤è¯

#### 4. æ–‡ä»¶æœåŠ¡æ¥å£

##### 4.1 æ–‡ä»¶ä¸Šä¼ 
- **æ¥å£**: `POST /api/v1/files/upload`
- **çŠ¶æ€**: ğŸŸ¡ å¾…è®¤è¯æµ‹è¯•
- **è¯´æ˜**: éœ€è¦ç”¨æˆ·Tokenè®¤è¯ï¼Œæ”¯æŒmultipart/form-data

#### 5. OAåå°ç®¡ç†æ¥å£

##### 5.1 OAç”¨æˆ·ç™»å½•
- **æ¥å£**: `POST /api/v1/admin/login`
- **çŠ¶æ€**: âœ… é€šè¿‡
- **è¯´æ˜**: æ”¯æŒç®¡ç†å‘˜ç™»å½•ï¼Œä½¿ç”¨ç”¨æˆ·å: admin, å¯†ç : admin123

##### 5.2 è·å–å¾…å®¡æ‰¹è´·æ¬¾ç”³è¯·åˆ—è¡¨
- **æ¥å£**: `GET /api/v1/admin/loans/applications/pending`
- **çŠ¶æ€**: ğŸŸ¡ å¾…è®¤è¯æµ‹è¯•
- **è¯´æ˜**: éœ€è¦ç®¡ç†å‘˜Tokenè®¤è¯

##### 5.3 è·å–è´·æ¬¾ç”³è¯·è¯¦æƒ…(ç®¡ç†å‘˜)
- **æ¥å£**: `GET /api/v1/admin/loans/applications/{application_id}`
- **çŠ¶æ€**: ğŸŸ¡ å¾…è®¤è¯æµ‹è¯•
- **è¯´æ˜**: éœ€è¦ç®¡ç†å‘˜Tokenè®¤è¯

##### 5.4 æäº¤å®¡æ‰¹å†³ç­–
- **æ¥å£**: `POST /api/v1/admin/loans/applications/{application_id}/review`
- **çŠ¶æ€**: ğŸŸ¡ å¾…è®¤è¯æµ‹è¯•
- **è¯´æ˜**: éœ€è¦ç®¡ç†å‘˜Tokenè®¤è¯

##### 5.5 æ§åˆ¶AIå®¡æ‰¹æµç¨‹å¼€å…³
- **æ¥å£**: `POST /api/v1/admin/system/ai-approval/toggle`
- **çŠ¶æ€**: ğŸŸ¡ å¾…è®¤è¯æµ‹è¯•
- **è¯´æ˜**: éœ€è¦ç®¡ç†å‘˜Tokenè®¤è¯

## æ•°æ®åº“åˆå§‹åŒ–çŠ¶æ€

### âœ… å·²åˆå§‹åŒ–çš„ç¤ºä¾‹æ•°æ®

1. **è´·æ¬¾äº§å“æ•°æ®** - 2ä¸ªç¤ºä¾‹äº§å“
   - æ˜¥è€•åŠ©åŠ›è´·ï¼ˆäº§å“ID: lp_b8a451a7-9c9ï¼‰
   - å†œæœºè´­ç½®è´·ï¼ˆäº§å“ID: lp_a2f345b8-1d4ï¼‰

2. **OAç®¡ç†å‘˜ç”¨æˆ·** - 1ä¸ªç®¡ç†å‘˜è´¦æˆ·
   - ç”¨æˆ·å: admin
   - å¯†ç : admin123
   - è§’è‰²: ADMIN

## æ¥å£åŠŸèƒ½éªŒè¯

### âœ… å·²éªŒè¯åŠŸèƒ½

1. **å¥åº·æ£€æŸ¥** - æœåŠ¡çŠ¶æ€æ­£å¸¸
2. **è´·æ¬¾äº§å“æŸ¥è¯¢** - æ•°æ®å®Œæ•´ï¼Œæ”¯æŒåˆ†ç±»ç­›é€‰
3. **éªŒè¯ç å‘é€** - æ¥å£æ­£å¸¸å“åº”
4. **OAç®¡ç†å‘˜ç™»å½•** - è´¦æˆ·éªŒè¯é€šè¿‡

### ğŸŸ¡ å¾…å®Œæ•´éªŒè¯åŠŸèƒ½

1. **ç”¨æˆ·æ³¨å†Œ/ç™»å½•æµç¨‹** - éœ€è¦å®Œæ•´æµ‹è¯•JWTç”Ÿæˆå’ŒéªŒè¯
2. **è´·æ¬¾ç”³è¯·æµç¨‹** - éœ€è¦ç”¨æˆ·è®¤è¯åæµ‹è¯•
3. **æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½** - éœ€è¦ç”¨æˆ·è®¤è¯åæµ‹è¯•
4. **OAç®¡ç†åŠŸèƒ½** - éœ€è¦ç®¡ç†å‘˜è®¤è¯åæµ‹è¯•
5. **é”™è¯¯å¤„ç†æœºåˆ¶** - éœ€è¦æµ‹è¯•å„ç§å¼‚å¸¸æƒ…å†µ

## æµ‹è¯•å·¥å…·

### PowerShellæµ‹è¯•å‘½ä»¤ç¤ºä¾‹

```powershell
# å¥åº·æ£€æŸ¥
Invoke-RestMethod -Uri "http://localhost:8080/health" -Method GET

# è·å–è´·æ¬¾äº§å“åˆ—è¡¨
Invoke-RestMethod -Uri "http://localhost:8080/api/v1/loans/products" -Method GET

# å‘é€éªŒè¯ç 
$body = @{phone = "13800138000"} | ConvertTo-Json
Invoke-RestMethod -Uri "http://localhost:8080/api/v1/users/send-verification-code" -Method POST -Body $body -ContentType "application/json"

# OAç®¡ç†å‘˜ç™»å½•
$adminBody = @{username = "admin"; password = "admin123"} | ConvertTo-Json
Invoke-RestMethod -Uri "http://localhost:8080/api/v1/admin/login" -Method POST -Body $adminBody -ContentType "application/json"
```

### Bashæµ‹è¯•å‘½ä»¤ç¤ºä¾‹ï¼ˆLinux/Macï¼‰

```bash
# å¥åº·æ£€æŸ¥
curl -X GET http://localhost:8080/health

# è·å–è´·æ¬¾äº§å“åˆ—è¡¨
curl -X GET http://localhost:8080/api/v1/loans/products

# å‘é€éªŒè¯ç 
curl -X POST http://localhost:8080/api/v1/users/send-verification-code \
  -H "Content-Type: application/json" \
  -d '{"phone": "13800138000"}'

# OAç®¡ç†å‘˜ç™»å½•
curl -X POST http://localhost:8080/api/v1/admin/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "admin123"}'
```

## ä¸‹ä¸€æ­¥æµ‹è¯•è®¡åˆ’

1. **å®Œæˆç”¨æˆ·è®¤è¯æµç¨‹æµ‹è¯•**
   - ç”¨æˆ·æ³¨å†Œ â†’ ç™»å½• â†’ è·å–Token â†’ è®¿é—®å—ä¿æŠ¤æ¥å£

2. **å®Œæˆç®¡ç†å‘˜è®¤è¯æµç¨‹æµ‹è¯•**
   - ç®¡ç†å‘˜ç™»å½• â†’ è·å–Token â†’ è®¿é—®ç®¡ç†æ¥å£

3. **å®Œæˆä¸šåŠ¡æµç¨‹æµ‹è¯•**
   - ç”¨æˆ·ç”³è¯·è´·æ¬¾ â†’ ç®¡ç†å‘˜å®¡æ‰¹ â†’ æµç¨‹çŠ¶æ€æ›´æ–°

4. **é”™è¯¯å¤„ç†æµ‹è¯•**
   - æ— æ•ˆå‚æ•°æµ‹è¯•
   - æœªæˆæƒè®¿é—®æµ‹è¯•
   - èµ„æºä¸å­˜åœ¨æµ‹è¯•

5. **æ€§èƒ½å’Œè¾¹ç•Œæµ‹è¯•**
   - å¤§æ•°æ®é‡æŸ¥è¯¢
   - æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶
   - å¹¶å‘è®¿é—®æµ‹è¯•

## æ€»ç»“

å½“å‰åç«¯æœåŠ¡çš„åŸºç¡€åŠŸèƒ½å·²ç»æ­£å¸¸è¿è¡Œï¼Œæ ¸å¿ƒæ¥å£å¯è®¿é—®ï¼Œæ•°æ®åº“åˆå§‹åŒ–å®Œæˆã€‚éœ€è¦è¿›ä¸€æ­¥å®Œå–„è®¤è¯æµç¨‹çš„å®Œæ•´æµ‹è¯•å’Œä¸šåŠ¡åŠŸèƒ½çš„ç«¯åˆ°ç«¯éªŒè¯ã€‚ 